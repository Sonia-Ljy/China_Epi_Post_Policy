data=fortify(tree)
# write.table(data, file = "epi_node_lineages.txt", append = FALSE, quote = FALSE, sep = "\t",
# na = "NA", row.names = FALSE,
# col.names = TRUE)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)
# geom_text(aes(subset=!isTip,label=support,color=support, hjust=-0.5),size=4)
# geom_nodelab(hjust=-0.05,size=4)
p1
tree
ggtree(tree)+geom_tiplab(size=4)+geom_nodelab(hjust=-0.05,size=4)
# 读取树文件（ggtree针对不同工具生成的树文件有不同的函数进行读取，如没有对应的函数，可以使用通用的办法读取）
tree <- read.tree("sub300ref_iqtree.fasta.treefile")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# 读取分组信息
group_file <- read.csv("meta_300.csv",header = T,row.names = 1)
##将地区替换为颜色
palette <- distinctColorPalette(length(unique(group_file$merged_lineage))+1)
# palette=c("#d62728","#1f77b4",  "#2ca02c", "#ff7f0e","#9467bd", "#8c564b", "#e377c2", "#17becf", "#bcbd22", "#7f7f7f","#800080")
palette = c("#82ADCF","#4F72B1","#F0B26D","#9C9A99","#5D9488","#9372A9","#F4D586","#C5432E","#B7D7E9")
class(palette)
# 按类分组
head(group_file)
groupInfo <- split(row.names(group_file), group_file$merged_lineage)
# 将分组信息添加到树中
tree <- groupOTU(tree, groupInfo)
# days_name <- unique(group_file$merged_lineage)
# 输出样本的节点和分组信息
data=fortify(tree)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)+
# geom_text(aes(subset=!isTip,label=support,color=support, hjust=-0.5),size=4)
# geom_nodelab(hjust=-0.05,size=4)
geom_tiplab(size=4)+geom_nodelab(hjust=-0.05,size=4)
p1
ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)
tree
# 读取树文件（ggtree针对不同工具生成的树文件有不同的函数进行读取，如没有对应的函数，可以使用通用的办法读取）
tree <- read.tree("sub300ref_iqtree.fasta.newick")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# 读取分组信息
group_file <- read.csv("meta_300.csv",header = T,row.names = 1)
##将地区替换为颜色
palette <- distinctColorPalette(length(unique(group_file$merged_lineage))+1)
# palette=c("#d62728","#1f77b4",  "#2ca02c", "#ff7f0e","#9467bd", "#8c564b", "#e377c2", "#17becf", "#bcbd22", "#7f7f7f","#800080")
palette = c("#82ADCF","#4F72B1","#F0B26D","#9C9A99","#5D9488","#9372A9","#F4D586","#C5432E","#B7D7E9")
class(palette)
# 按类分组
head(group_file)
groupInfo <- split(row.names(group_file), group_file$merged_lineage)
# 将分组信息添加到树中
tree <- groupOTU(tree, groupInfo)
# days_name <- unique(group_file$merged_lineage)
# 输出样本的节点和分组信息
data=fortify(tree)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)+
# geom_text(aes(subset=!isTip,label=support,color=support, hjust=-0.5),size=4)
# geom_nodelab(hjust=-0.05,size=4)
geom_tiplab(size=4)+geom_nodelab(hjust=-0.05,size=4)
p1
# 读取树文件（ggtree针对不同工具生成的树文件有不同的函数进行读取，如没有对应的函数，可以使用通用的办法读取）
tree <- read.tree("sub300ref_iqtree.fasta.newick")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# 读取分组信息
group_file <- read.csv("meta_300.csv",header = T,row.names = 1)
##将地区替换为颜色
palette <- distinctColorPalette(length(unique(group_file$merged_lineage))+1)
# palette=c("#d62728","#1f77b4",  "#2ca02c", "#ff7f0e","#9467bd", "#8c564b", "#e377c2", "#17becf", "#bcbd22", "#7f7f7f","#800080")
palette = c("#82ADCF","#4F72B1","#F0B26D","#9C9A99","#5D9488","#9372A9","#F4D586","#C5432E","#B7D7E9")
class(palette)
# 按类分组
head(group_file)
groupInfo <- split(row.names(group_file), group_file$merged_lineage)
# 将分组信息添加到树中
tree <- groupOTU(tree, groupInfo)
# days_name <- unique(group_file$merged_lineage)
# 输出样本的节点和分组信息
data=fortify(tree)
ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)
ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)+
# geom_text(aes(subset=!isTip,label=support,color=support, hjust=-0.5),size=4)
# geom_nodelab(hjust=-0.05,size=4)
geom_tiplab(size=4)+geom_nodelab(hjust=-0.05,size=4)
# 读取树文件（ggtree针对不同工具生成的树文件有不同的函数进行读取，如没有对应的函数，可以使用通用的办法读取）
tree <- read.tree("sub300ref_iqtree.fasta.newick")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# 读取分组信息
group_file <- read.csv("meta_300.csv",header = T,row.names = 1)
##将地区替换为颜色
palette <- distinctColorPalette(length(unique(group_file$merged_lineage))+1)
# palette=c("#d62728","#1f77b4",  "#2ca02c", "#ff7f0e","#9467bd", "#8c564b", "#e377c2", "#17becf", "#bcbd22", "#7f7f7f","#800080")
palette = c("#82ADCF","#4F72B1","#F0B26D","#9C9A99","#5D9488","#9372A9","#F4D586","#C5432E","#B7D7E9")
class(palette)
# 按类分组
head(group_file)
groupInfo <- split(row.names(group_file), group_file$merged_lineage)
# 将分组信息添加到树中
tree <- groupOTU(tree, groupInfo)
# days_name <- unique(group_file$merged_lineage)
# 输出样本的节点和分组信息
data=fortify(tree)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)+
# geom_text(aes(subset=!isTip,label=support,color=support, hjust=-0.5),size=4)
# geom_nodelab(hjust=-0.05,size=4)
geom_tiplab(size=4)+geom_nodelab(hjust=-0.05,size=4)
p1
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)+
# geom_text(aes(subset=!isTip,label=support,color=support, hjust=-0.5),size=4)
# geom_nodelab(hjust=-0.05,size=4)
geom_nodelab(hjust=-0.05,size=4)
p1
ggsave(filename = paste0("china_covsamper_compr_300_GTR_lin2",".pdf"),plot = p1,device = "pdf",width = 5, height = 8)
# 读取树文件
tree <- read.tree("sub300ref_iqtree.fasta.newick")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# 读取分组信息
group_file <- read.csv("meta_300.csv",header = T,row.names = 1)
##将地区替换为颜色
palette <- distinctColorPalette(length(unique(group_file$merged_lineage))+1)
palette = c("#F0B26D","#82ADCF","#4F72B1","#C5432E","#9C9A99","#9372A9","#5D9488","#F4D586","#B7D7E9")
class(palette)
# 按类分组
head(group_file)
groupInfo <- split(row.names(group_file), group_file$merged_lineage)
# 将分组信息添加到树中
tree <- groupOTU(tree, groupInfo)
# 输出样本的节点和分组信息
data=fortify(tree)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
scale_color_manual( values = palette)
p1
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
scale_color_manual( values = palette)+
geom_nodelab(hjust=-0.05,size=4)
p1
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
scale_color_manual( values = palette)+
geom_nodelab(hjust=-0.05,size=2)
p1
ggsave(filename = paste0("china_covsamper_compr_300_GTR_lin3",".pdf"),plot = p1,device = "pdf",width = 5, height = 8)
getwd()
setwd("/home/soniali/Desktop/02_china_recom_github/0_raw_data/covsampler_300/")
library(ggtree)
library(ggplot2)
library(treeio)
library(stringr)
library(randomcoloR)
require(graphics)
# 读取树文件
tree <- read.tree("sub300ref_iqtree.fasta.newick")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# 读取分组信息
group_file <- read.csv("meta_300.csv",header = T,row.names = 1)
##将地区替换为颜色
palette <- distinctColorPalette(length(unique(group_file$merged_lineage))+1)
palette = c("#F0B26D","#82ADCF","#4F72B1","#C5432E","#9C9A99","#9372A9","#5D9488","#F4D586","#B7D7E9")
class(palette)
# 按类分组
head(group_file)
groupInfo <- split(row.names(group_file), group_file$merged_lineage)
# 将分组信息添加到树中
tree <- groupOTU(tree, groupInfo)
# 输出样本的节点和分组信息
data=fortify(tree)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
scale_color_manual( values = palette)+
geom_nodelab(hjust=-0.05,size=2)
p1
ggsave(filename = paste0("china_covsamper_compr_300_GTR_lin3",".pdf"),plot = p1,device = "pdf",width = 5, height = 8)
# 读取树文件
tree <- read.tree("sub300ref_iqtree.fasta.newick")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# 读取分组信息
group_file <- read.csv("meta_300.csv",header = T,row.names = 1)
##将地区替换为颜色
palette <- distinctColorPalette(length(unique(group_file$merged_lineage))+1)
palette = c("#F0B26D","#82ADCF","#4F72B1","#C5432E","#9C9A99","#9372A9","#5D9488","#F4D586","#B7D7E9")
class(palette)
# 按类分组
head(group_file)
groupInfo <- split(row.names(group_file), group_file$merged_lineage)
# 将分组信息添加到树中
tree <- groupOTU(tree, groupInfo)
# 输出样本的节点和分组信息
data=fortify(tree)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
scale_color_manual( values = palette)#+
# geom_nodelab(hjust=-0.05,size=2)
p1
ggsave(filename = paste0("china_covsamper_compr_300_GTR_lin1",".pdf"),plot = p1,device = "pdf",width = 5, height = 8)
setwd("/home/soniali/Desktop/02_china_recom/0_raw_data/covsampler_300/")
# 加载R包
library("ggtree")
library("ggplot2")
library("treeio")
library(stringr)
library(randomcoloR)
require(graphics)
# 读取树文件（ggtree针对不同工具生成的树文件有不同的函数进行读取，如没有对应的函数，可以使用通用的办法读取）
tree <- read.tree("sub300ref_iqtree.fasta.newick")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# 读取分组信息
group_file <- read.csv("meta_300.csv",header = T,row.names = 1)
##将地区替换为颜色
palette <- distinctColorPalette(length(unique(group_file$merged_lineage))+1)
# palette=c("#d62728","#1f77b4",  "#2ca02c", "#ff7f0e","#9467bd", "#8c564b", "#e377c2", "#17becf", "#bcbd22", "#7f7f7f","#800080")
palette = c("#82ADCF","#4F72B1","#F0B26D","#9C9A99","#5D9488","#9372A9","#F4D586","#C5432E","#B7D7E9")
class(palette)
# 按类分组
head(group_file)
groupInfo <- split(row.names(group_file), group_file$merged_lineage)
# 将分组信息添加到树中
tree <- groupOTU(tree, groupInfo)
# days_name <- unique(group_file$merged_lineage)
# 输出样本的节点和分组信息
data=fortify(tree)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)+
# geom_text(aes(subset=!isTip,label=support,color=support, hjust=-0.5),size=4)
# geom_nodelab(hjust=-0.05,size=4)
geom_nodelab(hjust=-0.05,size=2)
p1
ggsave(filename = paste0("china_covsamper_compr_300_GTR_lin2",".pdf"),plot = p1,device = "pdf",width = 5, height = 8)
library(ggtree)
library(treeio)
library(ggplot2)
library(tidyverse)
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.newick("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick",node.label = 'support')
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()#+
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
p
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.newick("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick",node.label = 'support')
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# MRCA(tree, "EPI_ISL_18101315_FE.1", "EPI_ISL_18101313_FE.1")
# MRCA(tree, "C_AA030871.1_FR.1.1","C_AA037154.1_FR.1.1","C_AA037256.1_FR.1.1","C_AA037234.1_FR.1.1","C_AA037204.1_FR.1.1","C_AA037540.1_FR.1.1","C_AA038331.1_FR.1.1","C_AA038701.1_FR.1.1","C_AA036799.1_FR.1.1","C_AA036729.1_FR.1.1","EPI_ISL_17994535_FR.1.1","EPI_ISL_18060821_FR.1.1","EPI_ISL_18060751_FR.1.1","EPI_ISL_18074541_FR.1.1","EPI_ISL_18074511_FR.1.1","EPI_ISL_18074780_FR.1.1","EPI_ISL_18074563_FR.1.1","EPI_ISL_18074461_FR.1.1","EPI_ISL_18105577_FR.1.1","EPI_ISL_18108456_FR.1.1")
# MRCA(tree, "C_AA038410.1_recom","C_AA044601.1_recom","C_AA047643.1_recom","EPI_ISL_18284946_recom","EPI_ISL_18289774_recom","EPI_ISL_18289734_recom","EPI_ISL_18289815_recom","EPI_ISL_18401744_recom","EPI_ISL_18105656_recom")
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
tree <- read.newick("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick",node.label = 'support')
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
getwd()
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
ggsave(filename = paste0("FE.1_recom_FR.1.1_left_v2",".pdf"),plot = p,device = "pdf",width = 8, height = 5)
# 绘制进化树
p1 <- ggtree(tree,linetype=1,size=1.2,ladderize=T,color = "#3F3C3C")+ #xlim(0,0.0015) +
geom_tippoint(aes(color = group), show.legend = T,size = 3) +
xlim(0,0.0021)+geom_treescale()+
# theme(legend.position='none')+
scale_color_manual( values = palette)+
# geom_text(aes(subset=!isTip,label=support,color=support, hjust=-0.5),size=4)
# geom_nodelab(hjust=-0.05,size=4)
geom_nodelab(hjust=-0.05,size=2)
p1
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.newick("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick",node.label = 'support')
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
tree
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0045) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='top') +
geom_treescale() #+
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0045) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='top') +
geom_treescale() +geom_nodelab(hjust=-0.05,size=2)
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0045) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='top') +
geom_treescale() +geom_nodelab(hjust=-0.05,size=2)
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0045) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='top') +
geom_treescale() +geom_nodelab(hjust=-0.05,size=2)
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0045) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='top') +
geom_treescale() +geom_nodelab(hjust=-0.05,size=2)
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
# geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='left') +
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='left') +
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.newick("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick",node.label = 'support')
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
tree
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.tree("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick",node.label = 'support')
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.tree("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick",node.label = 'support')
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.tree("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick")
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
# MRCA(tree, "EPI_ISL_18101315_FE.1", "EPI_ISL_18101313_FE.1")
# MRCA(tree, "C_AA030871.1_FR.1.1","C_AA037154.1_FR.1.1","C_AA037256.1_FR.1.1","C_AA037234.1_FR.1.1","C_AA037204.1_FR.1.1","C_AA037540.1_FR.1.1","C_AA038331.1_FR.1.1","C_AA038701.1_FR.1.1","C_AA036799.1_FR.1.1","C_AA036729.1_FR.1.1","EPI_ISL_17994535_FR.1.1","EPI_ISL_18060821_FR.1.1","EPI_ISL_18060751_FR.1.1","EPI_ISL_18074541_FR.1.1","EPI_ISL_18074511_FR.1.1","EPI_ISL_18074780_FR.1.1","EPI_ISL_18074563_FR.1.1","EPI_ISL_18074461_FR.1.1","EPI_ISL_18105577_FR.1.1","EPI_ISL_18108456_FR.1.1")
# MRCA(tree, "C_AA038410.1_recom","C_AA044601.1_recom","C_AA047643.1_recom","EPI_ISL_18284946_recom","EPI_ISL_18289774_recom","EPI_ISL_18289734_recom","EPI_ISL_18289815_recom","EPI_ISL_18401744_recom","EPI_ISL_18105656_recom")
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='left') +
p
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.tree("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.newick")# read.newick
tree <- drop.tip(tree,'Reference')
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram())+#
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='left') +
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0045) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='top') +
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
ggsave(filename = paste0("FE.1_recom_FR.1.1_right_v2",".pdf"),plot = p,device = "pdf",width = 8, height = 5)
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/right/')
tree <- read.tree("FR.1.1_XCN_EG.5.1.1_masked_right.fasta.newick")# read.newick
tree <- drop.tip(tree,'Reference')
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram())+#
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='right') +
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0045) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
geom_treescale()+geom_nodelab(hjust=-0.05,size=2)
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
# theme(legend.position='top') +
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
ggsave(filename = paste0("FE.1_recom_FR.1.1_right_v2",".pdf"),plot = p,device = "pdf",width = 8, height = 5)
