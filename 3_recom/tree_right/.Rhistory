library(dplyr)
library(data.table)
library(ape)
library(treeio)
setwd("/home/soniali/Desktop/02_china_recom/0_raw_data/4_treetime/")
# 第一次运行
# load tree file
tree <- read.tree("/home/soniali/Desktop/02_china_recom/0_raw_data/4_treetime/aln_3000_tree.nwk")
# create vector list of seqIDs to drop from the tree
#根据2023-11-29_treetime0文件夹中的dates.tsv选择去除的tip
#"date	numeric date	lower bound	upper bound"为空
drop_tip <- c( "NODE_0001354","EPI_ISL_18465331","EPI_ISL_18518369","EPI_ISL_18376537")
# create vector list of seqIDs to drop from the tree
#根据2023-11-29_treetime0文件夹中的dates.tsv选择去除的tip
#"date	numeric date	lower bound	upper bound"为空
drop_tip <- c("NODE_0001354","EPI_ISL_18465331","EPI_ISL_18518369","EPI_ISL_18376537")
# now drop the tips from the tree
new_tree <- drop.tip(tree, drop_tip, trim.internal = TRUE)
# write the tree to file
write.tree(new_tree, file="new_tree_3000.nwk", append = FALSE)
library(ggtree)
library(treeio)
library(ggplot2)
library(tidyverse)
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/left/')
tree <- read.newick("FR.1.1_XCN_EG.5.1.1_masked_left.fasta.treefile",node.label = 'support')
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0018) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()+
geom_highlight(node = 61,fill = "#E4C4CB")+
geom_highlight(node = 33,fill = "#9FC6C4")
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0018) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()#+
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.018) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()#+
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.006) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()#+
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.003) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='left') +
geom_treescale()#+
p
ggsave(filename = paste0("FE.1_recom_FR.1.1_left_v1",".pdf"),plot = p,device = "pdf",width = 8, height = 5)
setwd('/home/soniali/Desktop/02_china_recom/2_XCN/snipit/right/')
tree <- read.newick("FR.1.1_XCN_EG.5.1.1_masked_right.fasta.treefile",node.label = 'support')
tree <- drop.tip(tree,'Reference') #删除游离的参考基因组样本
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.04) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='top') +
geom_treescale() #+
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.004) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='top') +
geom_treescale() #+
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
ggsave(filename = paste0("FE.1_recom_FR.1.1_right_v1",".pdf"),plot = p,device = "pdf",width = 8, height = 5)
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0042) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='top') +
geom_treescale() #+
p <-ggtree(tree,color='#C0C0C0',linetype=1,size=1.5,ladderize=T) + xlim(0,0.0045) + #  0.03  0.004
geom_tiplab(hjust = -0.05,size=3,fontface="italic",align = F,angle = 0,layout_dendrogram()) +#
# geom_point2(aes(subset=!isTip),fill="red",shape=21,size=4) + #A62B19
# geom_text2(aes(subset=!isTip,label=support,color=support, hjust=-0.6),size=4) +
# scale_color_gradient(high='red', low='Navy') +
# geom_cladelabel(node=61, label="zygote", offset = 10,barsize = 1,color=c("black","red2"), align=TRUE) +
theme(legend.position='top') +
geom_treescale() #+
# geom_highlight(node = 61,fill = "#E4C4CB")+
# geom_highlight(node = 33,fill = "#9FC6C4")
p
ggsave(filename = paste0("FE.1_recom_FR.1.1_right_v1",".pdf"),plot = p,device = "pdf",width = 8, height = 5)
